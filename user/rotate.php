<?php$title = "抽奖活动";require "head.php";require "../utils/pdo.php";require "../utils/page.class.php";?><style>    .ly-plate{		position:relative;		width:499px;		height:499px;		margin: 0 auto;	}	.rotate-bg{		width:499px;		height:499px;		background:url(./images/ly_rotate.png);		position:absolute;		top:0;		left:0	}	.ly-plate div.lottery-star{		width:105px;		height:105px;		position:absolute;		top:91px;		left:91px;		/*text-indent:-999em;		overflow:hidden;		background:url(rotate-static.png);		-webkit-transform:rotate(0deg);*/		outline:none	}	.ly-plate div.lottery-star #lotteryBtn{		cursor: pointer;		position: absolute;		top:43px;		left:109px;		*left:-90px	}</style><div class="right">        <div class="content_box boxshadow">            <div class="content_title">                <h5 class="pdl10">抽奖活动</h5>            </div>            <div class="content_rotate"><div class="ly-plate">		<div class="rotate-bg"></div>		<div class="lottery-star"><img src="./images/22.png" id="lotteryBtn"></div>	</div></div></div><div class="right" id="top-size">        <div class="content_box boxshadow">            <div class="content_title">                <h5 class="pdl10">获奖信息</h5>            </div>            <div class="content">					<table class="table_border line_height30" width="100%" cellspacing="0">                    <tr>                        <td class="tc" width="20%"><strong>时&nbsp;&nbsp;&nbsp;&nbsp;间</strong></td>                        <td class="tc" width="25%"><strong>抽奖项目</strong></td>                        <td class="tc" width="20%"><strong>消耗积分</strong></td>                        <td class="tc" width="25%"><strong>中奖情况</strong></td>                    </tr>                    <?php                    	/*                    	查询用户中奖纪录                    	 */                    	$rotate_count = $pdo->query("select count(*) from dou_rotate where uid=".$_SESSION['uid'],PDO::FETCH_ASSOC)->fetchColumn();                    	$page = new Page($rotate_count, 3);                        $sql_page = "select * from dou_rotate where uid=".$_SESSION['uid']." order by id desc {$page->limit}";                        $res = $pdo->query($sql_page);                        $result_v = $res->fetchAll(PDO::FETCH_ASSOC); 						foreach($result_v as $value){ 							$created = date("Y-m-d",$value['created']);                    ?>                    <tr>                        <td class="tc" width="20%"><?php echo $created;?></td>                        <td class="tc" width="35%"><?php echo $value['project'];?></td>                        <td class="tc" width="20%"><?php echo $value['pointer'];?></td>                        <td class="tc" width="25%"><?php echo $value['lottery'];?></td>                    </tr>                    <?php  } ?>                    </table>	</div>	<div style="margin-left:320px;"><?php echo $page->fpage(4, 5, 6); ?></div></div></div><script src="./js/jQueryRotate.2.2.js"></script><script src="./js/jquery.easing.min.js"></script><script>$(function(){	var timeOut = function(){  //超时函数		$("#lotteryBtn").rotate({			angle:0, 			duration: 10000, 			animateTo: 2160, //这里是设置请求超时后返回的角度，所以应该还是回到最原始的位置，2160是因为我要让它转6圈，就是360*6得来的			//easing: $.easing.easeInOutElastic,			callback:function(){				alert('网络超时')			}		}); 	}; 	var rotateFunc = function(awards,angle,text){  //awards:奖项，angle:奖项对应的角度		$('#lotteryBtn').stopRotate();		$("#lotteryBtn").rotate({			angle:0, 			duration: 5000, 			animateTo: angle+1440, //angle是图片上各奖项对应的角度，1440是我要让指针旋转4圈。所以最后的结束的角度就是这样子^^			//easing: $.easing.easeInOutElastic,			callback:function(){				test2(text,'rotate.php');			}		}); 	};		$("#lotteryBtn").rotate({ 	   bind: 		 { 			click: function(){						//解除click事件					$("#lotteryBtn").unbind('click');	                scscms_alert("您确定消耗100积分抽奖吗","confirm",function(){	        		$.ajax({	  					/*	  					  相应ajax传值	  					 */	                 	url:"ajax.php?cj=1",	                 	type:'POST',	                 	//data:{click_yes:click_yes},	                 	error:function(){	                 		timeOut();	                 	},	                 	success:function(data,status){						/*if(data==0){							var angle = [67,112,202,292,337];								angle = angle[Math.floor(Math.random()*angle.length)]							rotateFunc(0,angle,'很遗憾，这次您未抽中奖')						}*/						if(data>=136 && data<=150){							rotateFunc(1,22,'恭喜您获得200积分')						}						if(data==1){							rotateFunc(2,67,'恭喜您抽中三等奖！请确保个人信息中手机号畅通以方便与您取得联系')						}						if(data>=151 && data<=175){							rotateFunc(3,112,'恭喜您获得100积分')						}						if(data>=101 && data<=120){							rotateFunc(4,157,'恭喜您获得50积分')						}						if(data==5){							rotateFunc(5,202,'恭喜您抽中一等奖！请确保个人信息中手机号畅通以方便与您取得联系')						}						if(data>=121 && data<=135){							rotateFunc(6,247,'这次没中奖，再接再厉')						}						if(data==7){							rotateFunc(7,292,'恭喜您抽中二等奖！请确保个人信息中手机号畅通以方便与您取得联系')						}						if(data>=176 && data<=200){							rotateFunc(8,337,'恭喜您获得100积分')						}						if(data=='no'){							test6('对不起，您的积分不足无法进行抽奖','rotate.php');						}	                 	}	                });	},function(){		window.location.href = 'rotate.php';	});			}		} 	});})</script><?php require "foot.php"; ?>